# Impossible password

This one comes as a single ELF file, the challenge has the description: "Are you able to cheat me and get the flag?"

Changing permissions and running it doesnt give anything interesting, other than telling us its interactive

![image](https://user-images.githubusercontent.com/49762827/215344851-8f54e28e-31f1-40fb-87e7-ca670eeb0a1f.png)

Strings has revealed 1 interesting term, nothing else stands out

![image](https://user-images.githubusercontent.com/49762827/215344893-4a6e75d0-c19c-44cd-80b2-c2dd23acc80c.png)

Opening in Ghidra, the first thing to notice is that there is no main function as an easy starting point, however what is present in the entry point is the function `__libc_start_main`, hence it follows we can find the main function by following the first parameter passed into here, `FUN_0040085d`.

![image](https://user-images.githubusercontent.com/49762827/215345393-94801583-bbac-431b-a078-8bc6f51268f0.png)

Looking inside the function and starting to make sense of the variables and execution flow, I can see that there is a string compare, passing this then seemingly takes us to the next stage of the problem, indicated by getting `**` in the console as follows:

![image](https://user-images.githubusercontent.com/49762827/215345680-43071e9f-b7ee-425a-9d86-268b1b64a45d.png)

# Where to go

The hint for the challenge is "Are you able to cheat me and get the flag?", it seems as though there is a way to cheat the program to get the flag. The method which is called after passing the above stage is basically a random number generator, then returns out and a test is made to see if the user input is the same as the random number, whilst this could easily be engineered in C, this is simply passing a test.

In the vein of the hint, I could patch the file, or have a look in the third function. I can see it takes in an argument, which is part of a series of declarations at the top of the function. Looking inside this function it seems to iterate over this input and XOR's it with 9. Looking at the pattern of the declarations, this is probably a char array, and the char array is passed into the function, that makes more sense in terms of the iteration, so lets try that. I'll rename the declaration and also reveal the character assigned to the array.

![image](https://user-images.githubusercontent.com/49762827/215347625-e8c64e72-594b-4406-9ee2-b5527d01de6d.png)

Renaming the variables inside the function so it makes a little more sense:

![image](https://user-images.githubusercontent.com/49762827/215347709-68970c70-b105-4c47-8dcc-448d99a8badf.png)

Writing a quick python script to perform the XOR operation, we now get the flag!

![image](https://user-images.githubusercontent.com/49762827/215348247-575e1bb1-7533-4db9-b8ae-63c4a9cc4fe6.png)

![image](https://user-images.githubusercontent.com/49762827/215348325-75737f6f-5b14-43df-b5bd-97ef1fa1e303.png)


